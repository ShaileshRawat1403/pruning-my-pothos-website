---
import type { CollectionEntry } from 'astro:content';

interface Props {
  items: CollectionEntry<'systems'>[];
  tone?: string;
  columns?: number;
}

const { items, tone = 'var(--color-sticky-1)', columns = 2 } = Astro.props;
const cleanText = (value: string) => value.replace(/<[^>]*>/g, '');
---

{items.length > 0 ? (
  <div class="systems-grid" style={`--grid-columns: ${columns}; --card-tone: ${tone}`}>
    {items.map((system) => (
      <a
        href={`/systems/${system.slug}`}
        class="system-card"
      >
        <h2>{system.data.title}</h2>
        <p>{cleanText(system.data.description)}</p>
        <span class="read-more">Read more &rarr;</span>
      </a>
    ))}
  </div>
) : (
  <p class="systems-empty">No entries yet. First note coming soon.</p>
)}

<style>
  .systems-grid {
    display: grid;
    grid-template-columns: repeat(var(--grid-columns), minmax(0, 1fr));
    gap: 1.25rem;
    width: 100%;
    justify-items: stretch;
  }
  .system-card {
    background: color-mix(in srgb, var(--card-tone) 25%, var(--color-bg));
    border: 1px solid var(--color-border);
    border-radius: 14px;
    padding: 1.5rem;
    transition: border-color 0.2s ease, background-color 0.2s ease, transform 0.2s ease;
    color: var(--color-text-body);
    text-decoration: none;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    text-align: left;
  }
  .system-card:hover {
    border-color: var(--color-accent);
    transform: translateY(-2px);
  }
  .system-card h2 {
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
    color: var(--color-text-heading);
    min-height: 3.2em;
    line-height: 1.2;
  }
  .system-card p {
    color: var(--color-text-muted);
    font-size: 0.95rem;
    margin-bottom: 0.75rem;
    line-height: 1.5;
    min-height: 4.5em;
  }
  .read-more {
    font-family: var(--font-mono);
    font-size: 0.9rem;
    color: var(--color-accent);
    text-decoration: none;
    margin-top: auto;
  }
  @media (max-width: 800px) {
    .systems-grid {
      grid-template-columns: 1fr;
    }
  }
  .systems-empty {
    color: var(--color-text-muted);
    font-size: 0.95rem;
    margin: 0;
  }
</style>
